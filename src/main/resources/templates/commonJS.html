<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head(title)">
    <meta charset="UTF-8">
    <title th:text="${title}"></title>
    <meta name="viewport" content="width=1200px, initial-scale=1">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap-table.css}">
    <link rel="stylesheet" th:href="@{/css/select2.min.css}">
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/popper.min.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}"></script>
    <script th:src="@{/js/bootstrap-table.js}"></script>
    <script th:src="@{/js/headerfooter.js}"></script>
    <script th:src="@{/js/echarts.min.js}"></script>
    <script th:src="@{/js/dataTool.min.js}"></script>
    <script th:src="@{/js/plotly-latest.min.js}"></script>
    <script th:src="@{/js/FileSaver.min.js}"></script>
    <script th:src="@{/js/xlsx.core.min.js}"></script>
    <script th:src="@{/js/tableExport.min.js}"></script>
    <script th:src="@{/js/bootstrap-table-export.min.js}"></script>
    <script th:src="@{/js/select2.min.js}"></script>

    <style>
        .header {
            background-color:CornflowerBlue;
        }
        div.sticky{
            position: -webkit-sticky;
            position: sticky;
            top: 20px;
            padding: 5px;
            background-color: WhiteSmoke;
            border: 0px solid #4CAF50;
            color: black;
        }
        .table .thead-blue th {
            color: #337AB7;
            background-color: lightblue;
            border-color: lightskyblue;
            height:70px;
            align: 'center';
            valign: 'middle';
        }
    </style>

    <style type="text/css">
        table{
            border-collapse: collapse;
            width: 100%;
            table-layout: fixed;
        }
        table tr{
            height: 30px;
            overflow: hidden;
        }
        table td{
            width: 100px;
            height: 50px;
            word-wrap: break-word;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
        table td:hover{
            white-space:normal;
            overflow:auto;
        }
    </style>
</head>
<body>

</body>
<!--gene somatic-->
<script type="text/javascript" th:fragment="geneSInfo">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    $(document).ready(function () {
        $("#somatictable").bootstrapTable({
            url:"/cpgv/SearchSomaticMutationsByGene?gene="+gene,
            striped : true,
            pageNumber : 1,
            pagination : true,
            sidePagination : 'client',
            pageSize : 5,
            pageList : [ 5, 10],
            showRefresh : false,
            search : true,
            columns : [ {
                title : 'Gene Name',
                field : 'gene',
                align: 'center',
                sortable : true
            }, {
                title : 'Residue.g',
                field : 'gnumber',
                align: 'center',
                formatter: function(value,row,index) {
                    var url = '<a href="/cpgv/BrowseSomaticSite?site='+ row.gene+'.'+value +'" target="_blank">' + value +'</a>';
                    return url;
                },
                sortable : true
            }, {
                title : 'Chromosome',
                field : 'chr',
                align: 'center',
                sortable : true
            }, {
                title : 'Position',
                field : 'func',
                align: 'center',
                sortable : true
            }, {
                title : 'Type',
                field : 'exonicFunc',
                align: 'center',
                sortable : true
            }]
        })
    })
</script>

<script type="text/javascript" th:fragment="geneSN">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    const a = window.document.querySelector('#download1')
    a.addEventListener('click',()=>{
        const content = document.querySelector('#echartsBrowseSomaticGene1 svg').outerHTML
        const blob= new Blob([content], {type: 'xml/svg'})
        a.href = URL.createObjectURL(blob)
        a.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseSomaticGene1'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {
        },
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{},
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneNumber?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i + 1] = Number(data[i + 1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene1").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                myChart1.setOption({
                    title: {
                        text:'The number of somatic mutations in '+ gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSC">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a3 = window.document.querySelector('#download3')
    a3.addEventListener('click',()=>{
        const content3 = document.querySelector('#echartsBrowseSomaticGene3 svg').outerHTML
        const blob3= new Blob([content3], {type: 'xml/svg'})
        a3.href = URL.createObjectURL(blob3)
        a3.download = 'newplot.svg'
    })
    var myChart3 = echarts.init(document.querySelector('#echartsBrowseSomaticGene3'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatio2?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '';
            var result2 = '';
            var result3 = '';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                data[i+3]=Number(data[i+3]);
                if (data[i] != 0){
                    if (data[i +3] <0.05 & Math.abs(data[i]) >=0.263){
                        if (data[i] >= 0.263){
                            if (result1){
                                result1 = result1 +",[" + data[i]+","+data[i + 1] +","+"\""+ data[i + 2]+"\"" +"]";
                            }else{
                                result1 = "[" + data[i]+","+data[i + 1] +","+ "\""+data[i + 2]+"\"" +"]";
                            }
                        }else{
                            if (result2){
                                result2 = result2 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }else{
                                result2 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }
                        }
                    }else{
                        if (result3){
                            result3 = result3 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }else{
                            result3 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }
                    }
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var data2=JSON.parse("[" + result2 + "]");
            var data3=JSON.parse("[" + result3 + "]");
            var arrnum1=data1.length;
            var arrnum2=data2.length;
            var arrnum3=data3.length;
            var arrnum=arrnum1+arrnum2+arrnum3;
            if(arrnum == 0){
                document.getElementById("echartsBrowseSomaticGene3").innerHTML="Sorry, there is no value that meets the requirements in the volcano map";
            }
            else {
                var option;
                option = {
                    backgroundColor: "white",
                    title: {
                        text:'The carrier ratio of somatic mutations in '+gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                        data: ['Down', 'NoSignifi','Up']
                    },
                    xAxis: {
                        name:'Log2(Odds Ratio)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [10, 0, 0, 0]
                        },
                        type: 'value',
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        }
                    },
                    yAxis: {
                        name:'-Log10(FDR)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [0, 0, 20, 0]
                        },
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: 'grey',
                                width:0.05
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        },
                        scale: true
                    },
                    series: [{
                        name: 'Up',
                        data: data1,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'red',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: '1.2 times down',
                                xAxis:-0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'red'
                            }, {
                                offset: 1,
                                color: 'red'
                            }])
                        }
                    }, {
                        name: 'NoSignifi',
                        data: data3,
                        type: 'scatter',
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name:'1.2 times higher',
                                xAxis:0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'grey'
                            }, {
                                offset: 1,
                                color: 'grey'
                            }])
                        }
                    }, {
                        name: 'Down',
                        data: data2,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'blue',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: 'The change is not significant',
                                yAxis:1.3, //-log10(0.05)
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'blue'
                            }, {
                                offset: 1,
                                color: 'blue'
                            }])
                        }
                    }]
                };
                if (option && typeof option === 'object') {
                    myChart3.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSC2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    const a2 = window.document.querySelector('#download2')
    a2.addEventListener('click',()=>{
        const content2 = document.querySelector('#echartsBrowseSomaticGene2 svg').outerHTML
        const blob2= new Blob([content2], {type: 'xml/svg'})
        a2.href = URL.createObjectURL(blob2)
        a2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseSomaticGene2'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {
        },
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{},
        series:[{name:'Ratio',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatio?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i + 1] = Number(data[i + 1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene2").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                myChart1.setOption({
                    title: {
                        text:'The carrier ratio of somatic mutations in '+gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComW">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+1].split(";");
                zarray=zarray.map(Number);
                var number = {};
                var box = {};
                var meanline = {};
                box['visible']= true;
                number['box']=box;
                number['name'] = 'Wild type';
                number['type'] = 'violin';
                number['y'] = yarray;
                meanline['visible']= true;
                number['meanline']=meanline;

                var number1 = {};
                var box1 = {};
                var meanline1 = {};
                box1['visible']= true;
                number1['box']=box1;
                number1['name'] = 'Mutation';
                number1['type'] = 'violin';
                number1['y'] = zarray;
                meanline1['visible']= true;
                number1['meanline']=meanline1;

                numberall.push(number,number1);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene8").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text:'The distribution of age in patients with and without '+gene+' somatic mutations', font: { size: 13,family: "Arial black"}},
                    yaxis: {zeroline: false},
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseSomaticGene8')
                Plotly.plot('echartsBrowseSomaticGene8', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComW2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i+2].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+3].split(";");
                zarray=zarray.map(Number);
                var number = {};
                var marker = {};
                var line = {};
                number['name'] = 'female';
                number['type'] = 'bar';
                number['x'] = ['Wild type','Mutation'];
                number['y'] = yarray;
                line['width']= 1;
                line['color']= "#FF7F9E";
                marker['line']=line;
                marker['color']="#FF7F9E";
                number['marker'] = marker;
                number['orientation'] = 'v';

                var number1 = {};
                var marker1 = {};
                var line1 = {};
                number1['name'] = 'male';
                number1['type'] = 'bar';
                number1['x'] = ['Wild type','Mutation'];
                number1['y'] = zarray;
                line1['width']= 1;
                line1['color']= '#4171FF';
                marker1['line']=line1;
                marker1['color']='#4171FF';
                number1['marker'] = marker1;
                number1['orientation'] = 'v';

                numberall.push(number1,number);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene9").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of sex in patients with and without '+gene+' somatic mutations', font: { size: 13,family: "Arial black"}},
                    barmode: 'stack',
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseSomaticGene9')
                Plotly.plot('echartsBrowseSomaticGene9', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComW3">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var dom2 = document.getElementById("echartsBrowseSomaticGene10");
    myChart2 = echarts.init(dom2);
    var datacancer = ['Wild type','Mutation'];
    var hashcolor =['#8FBBD9','#FFBF86'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i+4].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+5].split(";");
                zarray=zarray.map(Number);
                var number = {};
                number['name'] = 'Wild type';
                number['type'] = 'box';
                number['y'] = yarray;

                var number1 = {};
                number1['name'] = 'Mutation';
                number1['type'] = 'box';
                number1['y'] = zarray;

                numberall.push(number,number1);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene10").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of CCF in patients with and without '+gene+' somatic mutations', font: { size: 13,family: "Arial black"}},
                    yaxis: {zeroline: false}
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseSomaticGene10')
                Plotly.plot('echartsBrowseSomaticGene10', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });

</script>

<script type="text/javascript" th:fragment="geneSComW4">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var dom3 = document.getElementById("echartsBrowseSomaticGene11");
    myChart3 = echarts.init(dom3);
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i+6].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+7].split(";");
                zarray=zarray.map(Number);
                var number = {};
                number['name'] = 'Wild type';
                number['type'] = 'box';
                number['y'] = yarray;

                var number1 = {};
                number1['name'] = 'Mutation';
                number1['type'] = 'box';
                number1['y'] = zarray;

                numberall.push(number,number1);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene11").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of TMB in patients with and without '+gene+' somatic mutations', font: { size: 13,family: "Arial black"}},
                    yaxis: {zeroline: false}
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseSomaticGene11')
                Plotly.plot('echartsBrowseSomaticGene11', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComT">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a4 = window.document.querySelector('#download4')
    a4.addEventListener('click',()=>{
        const content4 = document.querySelector('#echartsBrowseSomaticGene4 svg').outerHTML
        const blob4= new Blob([content4], {type: 'xml/svg'})
        a4.href = URL.createObjectURL(blob4)
        a4.download = 'newplot.svg'
    })
    var myChart3 = echarts.init(document.querySelector('#echartsBrowseSomaticGene4'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioVsTcga?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '';
            var result2 = '';
            var result3 = '';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                data[i+3]=Number(data[i+3]);
                if (data[i] != 0){
                    if (data[i +3] <0.05 & Math.abs(data[i]) >=0.263){
                        if (data[i] >= 0.263){
                            if (result1){
                                result1 = result1 +",[" + data[i]+","+data[i + 1] +","+"\""+ data[i + 2]+"\"" +"]";
                            }else{
                                result1 = "[" + data[i]+","+data[i + 1] +","+ "\""+data[i + 2]+"\"" +"]";
                            }
                        }else{
                            if (result2){
                                result2 = result2 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }else{
                                result2 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }
                        }
                    }else{
                        if (result3){
                            result3 = result3 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }else{
                            result3 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }
                    }
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var data2=JSON.parse("[" + result2 + "]");
            var data3=JSON.parse("[" + result3 + "]");
            var arrnum1=data1.length;
            var arrnum2=data2.length;
            var arrnum3=data3.length;
            var arrnum=arrnum1+arrnum2+arrnum3;
            if(arrnum == 0){
                document.getElementById("echartsBrowseSomaticGene4").innerHTML="Sorry, there is no value that meets the requirements in the volcano map.";
            }
            else {
                var option;
                option = {
                    backgroundColor: "white",
                    title: {
                        text:'The carrier ratio of somatic mutations in '+gene+' compared with that in TCGA',
                        textStyle:{
                          fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                        data: ['High in Genecast', 'NoSignifi','High in TCGA']
                    },
                    xAxis: {
                        name:'Log2(Odds Ratio)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [10, 0, 0, 0]
                        },
                        type: 'value',
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        }
                    },
                    yAxis: {
                        name:'-Log10(FDR)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [0, 0, 20, 0]
                        },
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: 'grey',
                                width:0.05
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        },
                        scale: true
                    },
                    series: [{
                        name: 'High in Genecast',
                        data: data1,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'red',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: '1.2 times down',
                                xAxis:-0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'red'
                            }, {
                                offset: 1,
                                color: 'red'
                            }])
                        }
                    }, {
                        name: 'NoSignifi',
                        data: data3,
                        type: 'scatter',
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name:'1.2 times higher',
                                xAxis:0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'grey'
                            }, {
                                offset: 1,
                                color: 'grey'
                            }])
                        }
                    }, {
                        name: 'High in TCGA',
                        data: data2,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'blue',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: 'The change is not significant',
                                yAxis:1.3,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'blue'
                            }, {
                                offset: 1,
                                color: 'blue'
                            }])
                        }
                    }]
                };
                if (option && typeof option === 'object') {
                    myChart3.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComT2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a6 = window.document.querySelector('#download6')
    a6.addEventListener('click',()=>{
        const content6 = document.querySelector('#echartsBrowseSomaticGene6 svg').outerHTML
        const blob6= new Blob([content6], {type: 'xml/svg'})
        a6.href = URL.createObjectURL(blob6)
        a6.download = 'newplot.svg'
    })
    var myChart4 = echarts.init(document.querySelector('#echartsBrowseSomaticGene6'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioVsTcga2?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '["product", "Genecast", "TCGA"]';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                result1 = result1 +",[" + "\""+data[i+2]+"\""+","+data[i] +","+ data[i+1] +"]";
            }
            var data1=JSON.parse("[" + result1 + "]");
            var arrnum =data1.length;
            var sum = 0;
            for (var j = 1;j < arrnum; j++ ){
                sum = sum + data1[j][1] + data1[j][2];
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene6").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                var option;
                option = {
                    title: {
                        text:'The carrier ratio of somatic mutations in '+gene+' compared with that in TCGA',
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                    },
                    tooltip: {},
                    dataset: {
                        source: data1
                    },
                    toolbox: {
                        top:20,
                        feature: {
                            magicType : {show: true, type: ['line','bar']},
                        }
                    },
                    xAxis: {
                        axisLabel:{
                            interval:0,
                            rotate:75,
                        },
                        type: 'category'
                    },
                    yAxis: {},
                    series: [
                        {type: 'line'},
                        {type: 'line'}
                    ]
                };
                if (option && typeof option === 'object') {
                    myChart4.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComG">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a5 = window.document.querySelector('#download5')
    a5.addEventListener('click',()=>{
        const content5 = document.querySelector('#echartsBrowseSomaticGene5 svg').outerHTML
        const blob5= new Blob([content5], {type: 'xml/svg'})
        a5.href = URL.createObjectURL(blob5)
        a5.download = 'newplot.svg'
    })
    var myChart3 = echarts.init(document.querySelector('#echartsBrowseSomaticGene5'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioVsGermline2?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '';
            var result2 = '';
            var result3 = '';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                data[i+3]=Number(data[i+3]);
                if (data[i] != 0){
                    if (data[i +3] <0.05 & Math.abs(data[i]) >=0.263){
                        if (data[i] >= 0.263){
                            if (result1){
                                result1 = result1 +",[" + data[i]+","+data[i + 1] +","+"\""+ data[i + 2]+"\"" +"]";
                            }else{
                                result1 = "[" + data[i]+","+data[i + 1] +","+ "\""+data[i + 2]+"\"" +"]";
                            }
                        }else{
                            if (result2){
                                result2 = result2 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }else{
                                result2 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }
                        }
                    }else{
                        if (result3){
                            result3 = result3 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }else{
                            result3 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }
                    }
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var data2=JSON.parse("[" + result2 + "]");
            var data3=JSON.parse("[" + result3 + "]");
            var arrnum1=data1.length;
            var arrnum2=data2.length;
            var arrnum3=data3.length;
            var arrnum=arrnum1+arrnum2+arrnum3;
            if(arrnum == 0){
                document.getElementById("echartsBrowseSomaticGene5").innerHTML="Sorry, there is no value that meets the requirements in the volcano map.";
            }
            else {
                var option;
                option = {
                    backgroundColor: "white",
                    title: {
                        text:'The carrier ratio of somatic mutations in '+gene+' \ncompared with that of germline mutations',
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[40,0,0,0],
                        align:'left',
                        data: ['High in Somatic', 'NoSignifi','High in Germline']
                    },
                    xAxis: {
                        name:'Log2(Odds Ratio)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [10, 0, 0, 0]
                        },
                        type: 'value',
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        }
                    },
                    yAxis: {
                        name:'-Log10(FDR)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [0, 0, 20, 0]
                        },
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: 'grey',
                                width:0.05
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        },
                        scale: true
                    },
                    series: [{
                        name: 'High in Somatic',
                        data: data1,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'red',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: '1.2 times down',
                                xAxis:-0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'red'
                            }, {
                                offset: 1,
                                color: 'red'
                            }])
                        }
                    }, {
                        name: 'NoSignifi',
                        data: data3,
                        type: 'scatter',
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name:'1.2 times higher',
                                xAxis:0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'grey'
                            }, {
                                offset: 1,
                                color: 'grey'
                            }])
                        }
                    }, {
                        name: 'High in Germline',
                        data: data2,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'blue',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: 'The change is not significant',
                                yAxis:1.3,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'blue'
                            }, {
                                offset: 1,
                                color: 'blue'
                            }])
                        }
                    }]
                };
                if (option && typeof option === 'object') {
                    myChart3.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneSComG2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a7 = window.document.querySelector('#download7')
    a7.addEventListener('click',()=>{
        const content7 = document.querySelector('#echartsBrowseSomaticGene7 svg').outerHTML
        const blob7= new Blob([content7], {type: 'xml/svg'})
        a7.href = URL.createObjectURL(blob7)
        a7.download = 'newplot.svg'
    })
    var myChart5 = echarts.init(document.querySelector('#echartsBrowseSomaticGene7'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioVsGermline?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '["product", "Somatic", "Germline"]';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                result1 = result1 +",[" + "\""+data[i+2]+"\""+","+data[i] +","+ data[i+1] +"]";
            }
            var data1=JSON.parse("[" + result1 + "]");
            var arrnum =data1.length;
            var sum = 0;
            for (var j = 1;j < arrnum; j++ ){
                sum = sum + data1[j][1] + data1[j][2];
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticGene7").innerHTML="Sorry, no somatic mutations in this gene were detected in these cancers.";
            }
            else {
                var option;
                option = {
                    title: {
                        text:'The carrier ratio of somatic mutations in '+gene+'\ncompared with that of germline mutations',
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[40,0,0,0],
                        align:'left',
                    },
                    tooltip: {},
                    dataset: {
                        source: data1
                    },
                    toolbox: {
                        top:20,
                        feature: {
                            magicType : {show: true, type: ['line','bar']},
                        }
                    },
                    xAxis: {
                        axisLabel:{
                            interval:0,
                            rotate:75,
                        },
                        type: 'category'
                    },
                    yAxis: {},
                    series: [
                        {type: 'line'},
                        {type: 'line'}
                    ]
                };
                if (option && typeof option === 'object') {
                    myChart5.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--gene germline-->
<script type="text/javascript" th:fragment="geneGInfo">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    $(document).ready(function () {
        $("#germlinetable").bootstrapTable({
            url:"/cpgv/SearchGermlineMutationsByGene?gene="+gene,
            striped : true,
            pageNumber : 1,
            pagination : true,
            sidePagination : 'client',
            pageSize : 5,
            pageList : [ 5, 10],
            showRefresh : false,
            search : true,
            columns : [ {
                title : 'Gene Name',
                field : 'gene',
                align: 'center',
                sortable : true
            }, {
                title : 'Residue.g',
                field : 'gnumber',
                align: 'center',
                formatter: function(value,row,index) {
                    var url = '<a href="/cpgv/BrowseGermlineSite?site='+ row.gene+'.'+value +'" target="_blank">' + value +'</a>';
                    return url;
                },
                sortable : true
            },{
                title : 'Chromosome',
                field : 'chr',
                align: 'center',
                sortable : true
            }, {
                title : 'Position',
                field : 'func',
                align: 'center',
                sortable : true
            }, {
                title : 'Type',
                field : 'exonicFunc',
                align: 'center',
                sortable : true
            }]
        })
    })
</script>

<script type="text/javascript" th:fragment="geneGN">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    const a_2 = window.document.querySelector('#download1_2')
    a_2.addEventListener('click',()=>{
        const content_2 = document.querySelector('#echartsBrowseGermlineGene1 svg').outerHTML
        const blob_2= new Blob([content_2], {type: 'xml/svg'})
        a_2.href = URL.createObjectURL(blob_2)
        a_2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseGermlineGene1'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{},
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneNumber?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i+1]=Number(data[i+1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene1").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                myChart1.setOption({
                    title: {
                        text:'The number of germline mutations in '+ gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGC">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a3_2 = window.document.querySelector('#download3_2')
    a3_2.addEventListener('click',()=>{
        const content3_2 = document.querySelector('#echartsBrowseGermlineGene3 svg').outerHTML
        const blob3_2= new Blob([content3_2], {type: 'xml/svg'})
        a3_2.href = URL.createObjectURL(blob3_2)
        a3_2.download = 'newplot.svg'
    })
    var myChart3 = echarts.init(document.querySelector('#echartsBrowseGermlineGene3'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatio2?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '';
            var result2 = '';
            var result3 = '';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                data[i+3]=Number(data[i+3]);
                if (data[i] != 0){
                    if (data[i +3] <0.05 & Math.abs(data[i]) >=0.263){
                        if (data[i] >= 0.263){
                            if (result1){
                                result1 = result1 +",[" + data[i]+","+data[i + 1] +","+"\"s"+ data[i + 2]+"\"" +"]";
                            }else{
                                result1 = "[" + data[i]+","+data[i + 1] +","+ "\""+data[i + 2]+"\"" +"]";
                            }
                        }else{
                            if (result2){
                                result2 = result2 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }else{
                                result2 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }
                        }
                    }else{
                        if (result3){
                            result3 = result3 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }else{
                            result3 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }
                    }
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var data2=JSON.parse("[" + result2 + "]");
            var data3=JSON.parse("[" + result3 + "]");
            var arrnum1=data1.length;
            var arrnum2=data2.length;
            var arrnum3=data3.length;
            var arrnum=arrnum1+arrnum2+arrnum3;
            if(arrnum == 0){
                document.getElementById("echartsBrowseGermlineGene3").innerHTML="Sorry, there is no value that meets the requirements in the volcano map.";
            }
            else {
                var option;
                option = {
                    backgroundColor: "white",
                    title: {
                        text:'The carrier ratio of germline mutations in '+gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                        data: ['Down', 'NoSignifi','Up']
                    },
                    xAxis: {
                        name:'Log2(Odds Ratio)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [10, 0, 0, 0]
                        },
                        type: 'value',
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        }
                    },
                    yAxis: {
                        name:'-Log10(FDR)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [0, 0, 20, 0]
                        },
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: 'grey',
                                width:0.05
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        },
                        scale: true
                    },
                    series: [{
                        name: 'Up',
                        data: data1,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'red',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: '1.2 times down',
                                xAxis:-0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'red'
                            }, {
                                offset: 1,
                                color: 'red'
                            }])
                        }
                    }, {
                        name: 'NoSignifi',
                        data: data3,
                        type: 'scatter',
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name:'1.2 times higher',
                                xAxis:0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'grey'
                            }, {
                                offset: 1,
                                color: 'grey'
                            }])
                        }
                    }, {
                        name: 'Down',
                        data: data2,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'blue',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: 'The change is not significant',
                                yAxis:1.3,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'blue'
                            }, {
                                offset: 1,
                                color: 'blue'
                            }])
                        }
                    }]
                };
                if (option && typeof option === 'object') {
                    myChart3.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGC2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    const a2_2 = window.document.querySelector('#download2_2')
    a2_2.addEventListener('click',()=>{
        const content2_2 = document.querySelector('#echartsBrowseGermlineGene2 svg').outerHTML
        const blob2_2= new Blob([content2_2], {type: 'xml/svg'})
        a2_2.href = URL.createObjectURL(blob2_2)
        a2_2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseGermlineGene2'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{},
        series:[{name:'Ratio',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatio?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i+1]=Number(data[i+1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene2").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                myChart1.setOption({
                    title: {
                        text:'The carrier ratio of germline mutations in '+gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComW">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+1].split(";");
                zarray=zarray.map(Number);
                var number = {};
                var box = {};
                var meanline = {};
                box['visible']= true;
                number['box']=box;
                number['name'] = 'Wild type';
                number['type'] = 'violin';
                number['y'] = yarray;
                meanline['visible']= true;
                number['meanline']=meanline;

                var number1 = {};
                var box1 = {};
                var meanline1 = {};
                box1['visible']= true;
                number1['box']=box1;
                number1['name'] = 'Mutation';
                number1['type'] = 'violin';
                number1['y'] = zarray;
                meanline1['visible']= true;
                number1['meanline']=meanline1;

                numberall.push(number,number1);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene8").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of age in patients with and without '+gene+' germline mutations', font: { size: 13,family: "Arial black"}},
                    yaxis: {zeroline: false}
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseGermlineGene8')
                Plotly.plot('echartsBrowseGermlineGene8', {
                    data: data,
                    layout: layout,
                    config:config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComW2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i+2].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+3].split(";");
                zarray=zarray.map(Number);
                var number = {};
                var marker = {};
                var line = {};
                number['name'] = 'female';
                number['type'] = 'bar';
                number['x'] = ['Wild type','Mutation'];
                number['y'] = yarray;
                line['width']= 1;
                line['color']= "#FF7F9E";
                marker['line']=line;
                marker['color']="#FF7F9E";
                number['marker'] = marker;
                number['orientation'] = 'v';

                var number1 = {};
                var marker1 = {};
                var line1 = {};
                number1['name'] = 'male';
                number1['type'] = 'bar';
                number1['x'] = ['Wild type','Mutation'];
                number1['y'] = zarray;
                line1['width']= 1;
                line1['color']= '#4171FF';
                marker1['line']=line1;
                marker1['color']='#4171FF';
                number1['marker'] = marker1;
                number1['orientation'] = 'v';

                numberall.push(number1,number);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene9").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of sex in patients with and without '+gene+' germline mutations', font: { size: 13,family: "Arial black"}},
                    barmode: 'stack',
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseGermlineGene9')
                Plotly.plot('echartsBrowseGermlineGene9', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComW3">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var dom2 = document.getElementById("echartsBrowseGermlineGene10");
    myChart2 = echarts.init(dom2);
    var datacancer = ['Wild type','Mutation'];
    var hashcolor =['#8FBBD9','#FFBF86'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i+4].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+5].split(";");
                zarray=zarray.map(Number);
                var number = {};
                number['name'] = 'Wild type';
                number['type'] = 'box';
                number['y'] = yarray;

                var number1 = {};
                number1['name'] = 'Mutation';
                number1['type'] = 'box';
                number1['y'] = zarray;

                numberall.push(number,number1);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene10").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of CCF in patients with and without '+gene+' germline mutations', font: { size: 13,family: "Arial black"}},
                    yaxis: {zeroline: false}
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseGermlineGene10')
                Plotly.plot('echartsBrowseGermlineGene10', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComW4">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var dom3 = document.getElementById("echartsBrowseGermlineGene11");
    myChart3 = echarts.init(dom3);
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneCom?gene="+gene,
        async:false,
        cache:false,
        success:function (data){
            var yarray = [];
            var zarray = [];
            var numberall = [];
            for (var i = 0;i < data.length;){
                yarray=data[i+6].split(";");
                yarray=yarray.map(Number);
                zarray=data[i+7].split(";");
                zarray=zarray.map(Number);
                var number = {};
                number['name'] = 'Wild type';
                number['type'] = 'box';
                number['y'] = yarray;

                var number1 = {};
                number1['name'] = 'Mutation';
                number1['type'] = 'box';
                number1['y'] = zarray;

                numberall.push(number,number1);
                i = i + 8;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene11").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                data = numberall;
                layout = {
                    title: { text: 'The distribution of TMB in patients with and without '+gene+' germline mutations', font: { size: 13,family: "Arial black"}},
                    yaxis: {zeroline: false}
                };
                config ={
                    toImageButtonOptions: {
                        format: 'svg',
                        filename: "newplot",
                        height: 450,
                        width: 800,
                        scale: 1
                    },
                    modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                    displaylogo: false,
                    displayModeBar: true,
                };
                Plotly.purge('echartsBrowseGermlineGene11')
                Plotly.plot('echartsBrowseGermlineGene11', {
                    data: data,
                    layout: layout,
                    config: config
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComT">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a4_2 = window.document.querySelector('#download4_2')
    a4_2.addEventListener('click',()=>{
        const content4_2 = document.querySelector('#echartsBrowseGermlineGene4 svg').outerHTML
        const blob4_2= new Blob([content4_2], {type: 'xml/svg'})
        a4_2.href = URL.createObjectURL(blob4_2)
        a4_2.download = 'newplot.svg'
    })
    var myChart3 = echarts.init(document.querySelector('#echartsBrowseGermlineGene4'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatioVsTcga?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '';
            var result2 = '';
            var result3 = '';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                data[i+3]=Number(data[i+3]);
                if (data[i] != 0){
                    if (data[i +3] <0.05 & Math.abs(data[i]) >=0.263){
                        if (data[i] >= 0.263){
                            if (result1){
                                result1 = result1 +",[" + data[i]+","+data[i + 1] +","+"\"s"+ data[i + 2]+"\"" +"]";
                            }else{
                                result1 = "[" + data[i]+","+data[i + 1] +","+ "\""+data[i + 2]+"\"" +"]";
                            }
                        }else{
                            if (result2){
                                result2 = result2 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }else{
                                result2 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                            }
                        }
                    }else{
                        if (result3){
                            result3 = result3 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }else{
                            result3 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                        }
                    }
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var data2=JSON.parse("[" + result2 + "]");
            var data3=JSON.parse("[" + result3 + "]");
            var arrnum1=data1.length;
            var arrnum2=data2.length;
            var arrnum3=data3.length;
            var arrnum=arrnum1+arrnum2+arrnum3;
            if(arrnum == 0){
                document.getElementById("echartsBrowseGermlineGene4").innerHTML="Sorry, there is no value that meets the requirements in the volcano map";
            }
            else {
                var option;
                option = {
                    backgroundColor: "white",
                    title: {
                        text:'The carrier ratio of germline mutations in '+gene+' compared with that in TCGA',
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                        data: ['High in Genecast', 'NoSignifi','High in TCGA']
                    },
                    xAxis: {
                        name:'Log2(Odds Ratio)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [10, 0, 0, 0]
                        },
                        type: 'value',
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        }
                    },
                    yAxis: {
                        name:'-Log10(FDR)',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [0, 0, 20, 0]
                        },
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: 'grey',
                                width:0.05
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        },
                        scale: true
                    },
                    series: [{
                        name: 'High in Genecast',
                        data: data1,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'red',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: '1.2 times down',
                                xAxis:-0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'red'
                            }, {
                                offset: 1,
                                color: 'red'
                            }])
                        }
                    }, {
                        name: 'NoSignifi',
                        data: data3,
                        type: 'scatter',
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name:'1.2 times higher',
                                xAxis:0.263,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'grey'
                            }, {
                                offset: 1,
                                color: 'grey'
                            }])
                        }
                    }, {
                        name: 'High in TCGA',
                        data: data2,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'blue',
                        },
                        markLine: {
                            symbol: ['none', 'none'],
                            itemStyle: {
                                normal: { lineStyle: { type: 'dashed', color:'grey'}
                                    ,label: { show: false, position:'left' } }
                            },
                            data: [{
                                name: 'The change is not significant',
                                yAxis:1.3,
                            },
                            ]
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'blue'
                            }, {
                                offset: 1,
                                color: 'blue'
                            }])
                        }
                    }]
                };
                if (option && typeof option === 'object') {
                    myChart3.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComT2">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a6_2 = window.document.querySelector('#download6_2')
    a6_2.addEventListener('click',()=>{
        const content6_2 = document.querySelector('#echartsBrowseGermlineGene6 svg').outerHTML
        const blob6_2= new Blob([content6_2], {type: 'xml/svg'})
        a6_2.href = URL.createObjectURL(blob6_2)
        a6_2.download = 'newplot.svg'
    })
    var myChart6 = echarts.init(document.querySelector('#echartsBrowseGermlineGene6'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatioVsTcga2?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '["product", "Genecast", "TCGA"]';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                result1 = result1 +",[" + "\""+data[i+2]+"\""+","+data[i] +","+ data[i+1] +"]";
            }
            var data1=JSON.parse("[" + result1 + "]");
            var arrnum =data1.length;
            var sum = 0;
            for (var j = 1;j < arrnum; j++ ){
                sum = sum + data1[j][1] + data1[j][2];
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineGene6").innerHTML="Sorry, no germline mutations in this gene were detected in these cancers.";
            }
            else {
                var option;
                option = {
                    title: {
                        text:'The carrier ratio of germline mutations in '+gene+' compared with that in TCGA',
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                    },
                    tooltip: {},
                    dataset: {
                        source: data1
                    },
                    toolbox: {
                        top:20,
                        feature: {
                            magicType : {show: true, type: ['line','bar']},
                        }
                    },
                    xAxis: {
                        axisLabel:{
                            interval:0,
                            rotate:75,
                        },
                        type: 'category'
                    },
                    yAxis: {},
                    series: [
                        {type: 'line'},
                        {type: 'line'}
                    ]
                };
                if (option && typeof option === 'object') {
                    myChart6.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="geneGComC">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    const a5_2 = window.document.querySelector('#download5_2')
    a5_2.addEventListener('click',()=>{
        const content5_2 = document.querySelector('#echartsBrowseGermlineGene5 svg').outerHTML
        const blob5_2= new Blob([content5_2], {type: 'xml/svg'})
        a5_2.href = URL.createObjectURL(blob5_2)
        a5_2.download = 'newplot.svg'
    })
    var myChart4 = echarts.init(document.querySelector('#echartsBrowseGermlineGene5'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatioVsCaspmi?gene=" + gene,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '';
            var result2 = '';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                if (data[i] > data[i + 1]){
                    if (result1){
                        result1 = result1 +",[" + data[i]+","+data[i + 1] +","+"\"s"+ data[i + 2]+"\"" +"]";
                    }else{
                        result1 = "[" + data[i]+","+data[i + 1] +","+ "\""+data[i + 2]+"\"" +"]";
                    }
                }else{
                    if (result2){
                        result2 = result2 +",[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                    }else{
                        result2 = "[" + data[i]+","+data[i + 1] +","+"\""+data[i + 2]+"\"" +"]";
                    }
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var data2=JSON.parse("[" + result2 + "]");
            var arrnum1=data1.length;
            var arrnum2=data2.length;
            var arrnum=arrnum1+arrnum2;
            if(arrnum == 0){
                document.getElementById("echartsBrowseGermlineGene5").innerHTML="Sorry, no identical germline mutations in this gene were detected in CASPMI.";
            }
            else {
                var option;
                option = {
                    backgroundColor: "white",
                    title: {
                        text:'The MAF of germline mutations in '+gene+' compared with that in CASPMI',
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[30,0,0,0],
                        align:'left',
                        data: ['High in Genecast', 'High in CASPMI']
                    },
                    xAxis: {
                        name:'MAF in Genecast',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [10, 0, 0, 0]
                        },
                        type: 'value',
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        }
                    },
                    yAxis: {
                        name:'MAF in CASPMI',
                        nameLocation:'center',
                        nameTextStyle: {
                            padding: [0, 0, 30, 0]
                        },
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: 'grey',
                                width:0.05
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                type: 'solid'
                            }
                        },
                        scale: true
                    },
                    series: [{
                        name: 'High in CASPMI',
                        data: data2,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'red',
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'red'
                            }, {
                                offset: 1,
                                color: 'red'
                            }])
                        }
                    },{
                        name: 'High in Genecast',
                        data: data1,
                        type: 'scatter',
                        label: {
                            show: true,
                            formatter:"{@[2]}",
                            position: 'right',
                            color: 'blue',
                        },
                        emphasis: {
                            label: {
                                show: true,
                                formatter: function (param) {
                                    return (param.data[2] +"( "+param.data[0]+", "+param.data[1]+" )");
                                },
                                position: 'top'
                            }
                        },
                        itemStyle: {
                            color: new echarts.graphic.RadialGradient(0.4, 0.3, 1, [{
                                offset: 0,
                                color: 'blue'
                            }, {
                                offset: 1,
                                color: 'blue'
                            }])
                        }
                    }]
                };
                if (option && typeof option === 'object') {
                    myChart4.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--type somatic-->
<script type="text/javascript" th:fragment="typeSN">
    const aT = window.document.querySelector('#downloadT1')
    aT.addEventListener('click',()=>{
        const contentT = document.querySelector('#echartsBrowseSomaticType1 svg').outerHTML
        const blobT= new Blob([contentT], {type: 'xml/svg'})
        aT.href = URL.createObjectURL(blobT)
        aT.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseSomaticType1'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:45,
            }
        },
        yAxis:{},
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneNumberByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var numberall = [];
            for (var i = 0;i < data.length;i = i + 2){
                data[i + 1] = Number(data[i + 1]);
                if(data[i + 1] != 0){
                    var number = {};
                    number['value'] = data[i + 1];
                    number['name'] = data[i];
                    numberall.push(number);
                }
            }
            numberall.sort(function (a,b) {return b.value -a.value});
            var arrnum = numberall.length;
            if(arrnum == 0){
                document.getElementById("echartsBrowseSomaticType1").innerHTML="Sorry, no somatic mutations were detected in this cancer.";
            }
            else{
                var categories =[];
                var numberall1 =[];
                if (arrnum >20){
                    numberall1 = numberall.splice(20);
                }
                for (var j = 0;j < numberall.length;j++){
                    categories[j] = numberall[j].name;
                }
                myChart1.setOption({
                    title: {
                        text:'The number of somatic mutations \noccurring in top 20 mutated genes in '+ type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeSC">
    const aT2 = window.document.querySelector('#downloadT2')
    aT2.addEventListener('click',()=>{
        const contentT2 = document.querySelector('#echartsBrowseSomaticType2 svg').outerHTML
        const blobT2= new Blob([contentT2], {type: 'xml/svg'})
        aT2.href = URL.createObjectURL(blobT2)
        aT2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseSomaticType2'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:45,
            }
        },
        yAxis:{},
        series:[{name:'Ratio',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var numberall = [];
            for (var i = 0;i < data.length;i = i + 2){
                data[i + 1] = Number(data[i + 1]);
                if(data[i + 1] != 0){
                    var number = {};
                    number['value'] = data[i + 1];
                    number['name'] = data[i];
                    numberall.push(number);
                }
            }
            numberall.sort(function (a,b) {return b.value -a.value});
            var arrnum = numberall.length;
            if(arrnum == 0){
                document.getElementById("echartsBrowseSomaticType2").innerHTML="Sorry, no somatic mutations were detected in this cancer.";
            }
            else {
                var categories =[];
                var numberall1 =[];
                if (arrnum >20){
                    numberall1 = numberall.splice(20);
                }
                for (var j = 0;j < numberall.length;j++){
                    categories[j] = numberall[j].name;
                }
                myChart1.setOption({
                    title: {
                        text:'The carrier ratio of somatic mutations \noccurring in top 20 mutated genes in '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeSComT">
    const aT4 = window.document.querySelector('#downloadT4')
    aT4.addEventListener('click',()=>{
        const contentT4 = document.querySelector('#echartsBrowseSomaticType4 svg').outerHTML
        const blobT4= new Blob([contentT4], {type: 'xml/svg'})
        aT4.href = URL.createObjectURL(blobT4)
        aT4.download = 'newplot.svg'
    })
    var myChart4 =echarts.init(document.querySelector('#echartsBrowseSomaticType4'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioVsTcgaByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '["product", "Genecast", "TCGA"]';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                if(data[i] != 0){
                    result1 = result1 +",[" + "\""+data[i+2]+"\""+","+data[i] +","+ data[i+1] +"]";
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var arrnum = data1.length;
            if(arrnum <= 1){
                document.getElementById("echartsBrowseSomaticType4").innerHTML="Sorry, this cancer type is not recorded in TCGA.";
            }
            else {
                var numberall1 =[];
                if (arrnum >21){
                    numberall1 = data1.splice(21);
                }
                var option;
                option = {
                    title: {
                        text:'The carrier ratio of somatic mutations within top 20 mutated genes \ncompared with TCGA in '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[40,0,0,0],
                        align:'left',
                    },
                    tooltip: {},
                    dataset: {
                        source: data1
                    },
                    toolbox: {
                        top:20,
                        feature: {
                            magicType : {show: true, type: ['line','bar']},
                        }
                    },
                    xAxis: {
                        axisLabel:{
                            interval:0,
                            rotate:45,
                        },
                        type: 'category'
                    },
                    yAxis: {},
                    series: [
                        {type: 'line',},
                        {type: 'line',}
                    ]
                };
                if (option && typeof option === 'object') {
                    myChart4.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeSComG">
    const aT7 = window.document.querySelector('#downloadT7')
    aT7.addEventListener('click',()=>{
        const contentT7 = document.querySelector('#echartsBrowseSomaticType7 svg').outerHTML
        const blobT7= new Blob([contentT7], {type: 'xml/svg'})
        aT7.href = URL.createObjectURL(blobT7)
        aT7.download = 'newplot.svg'
    })
    var myChart5 =echarts.init(document.querySelector('#echartsBrowseSomaticType7'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticGeneRatioVsGermlineByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '["product", "Somatic", "Germline"]';

            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                if(data[i] != 0){
                    result1 = result1 +",[" + "\""+data[i+2]+"\""+","+data[i] +","+ data[i+1] +"]";
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var arrnum = data1.length;
            if(arrnum <= 1){
                document.getElementById("echartsBrowseSomaticType7").innerHTML="Sorry, there is no value that meets the requirements.";
            }
            else {
                var numberall1 =[];
                if (arrnum >21){
                    numberall1 = data1.splice(21);
                }
                var option;
                option = {
                    title: {
                        text:'The carrier ratio of somatic mutations in top 20 genes \ncompared with that of germline mutations in '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[40,0,0,0],
                        align:'left',
                    },
                    tooltip: {},
                    dataset: {
                        source: data1
                    },
                    toolbox: {
                        top:20,
                        feature: {
                            magicType : {show: true, type: ['line','bar']},
                        }
                    },
                    xAxis: {
                        axisLabel:{
                            interval:0,
                            rotate:45,
                        },
                        type: 'category'
                    },
                    yAxis: {},
                    series: [
                        {type: 'line'},
                        {type: 'line'}
                    ]
                };
                if (option && typeof option === 'object') {
                    myChart5.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeSDT">
    const aT5 = window.document.querySelector('#downloadT5')
    aT5.addEventListener('click',()=>{
        const contentT5 = document.querySelector('#echartsBrowseSomaticType5 svg').outerHTML
        const blobT5= new Blob([contentT5], {type: 'xml/svg'})
        aT5.href = URL.createObjectURL(blobT5)
        aT5.download = 'newplot.svg'
    })
    var myChart3 =echarts.init(document.querySelector('#echartsBrowseSomaticType5'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticTmbByType?type=" + type,
        async:false,
        cache:false,
        success:function (dataSet){
            var result1 = [];
            var result2 = [];
            for (var i = 0;i < dataSet.length; i = i + 2){
                result1.push(dataSet[i + 1]);
                result2.push(dataSet[i]);
            }
            result2 = delRepeat2(result2);
            var data = echarts.dataTool.prepareBoxplotData([result1]);
            var d1=(result2);
            var option;
            option = {
                title: [
                    {
                        text: 'The distribution of TMB in patients with '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center',
                    },
                    {
                        text: 'upper: Q3 + 1.5 * IRQ \nlower: Q1 - 1.5 * IRQ',
                        borderColor: 'black',
                        borderWidth: 1,
                        textStyle: {
                            fontSize: 12,
                            color:'black'
                        },
                        left: '10%',
                        top: '90%'
                    }
                ],
                tooltip: {
                    trigger: 'item',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '10%',
                    right: '10%',
                    bottom: '15%'
                },
                xAxis: {
                    type: 'category',
                    data: [result2],
                    boundaryGap: true,
                    nameGap: 30,
                    splitArea: {
                        show: false
                    },
                    axisLabel: {
                        formatter: '{value}'
                    },
                    splitLine: {
                        show: false
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'Number',
                    splitArea: {
                        show: true
                    }
                },
                series: [
                    {
                        name: 'boxplot',
                        type: 'boxplot',
                        data: data.boxData,
                        tooltip: {
                            formatter: function (param) {
                                return [
                                    param.name + ': ',
                                    'upper: ' + param.data[5],
                                    'Q3: ' + param.data[4],
                                    'median: ' + param.data[3],
                                    'Q1: ' + param.data[2],
                                    'lower: ' + param.data[1]
                                ].join('<br/>')
                            }
                        }
                    },
                    {
                        name: 'outlier',
                        type: 'scatter',
                        data: data.outliers
                    }
                ]
            };
            if (option && typeof option === 'object') {
                myChart3.setOption(option);
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeSDS">
    const aT6 = window.document.querySelector('#downloadT6')
    aT6.addEventListener('click',()=>{
        const contentT6 = document.querySelector('#echartsBrowseSomaticType6 svg').outerHTML
        const blobT6= new Blob([contentT6], {type: 'xml/svg'})
        aT6.href = URL.createObjectURL(blobT6)
        aT6.download = 'newplot.svg'
    })
    var myChart3 =echarts.init(document.querySelector('#echartsBrowseSomaticType6'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseSomaticSignatureByType?type=" + type,
        async:false,
        cache:false,
        success:function (dataSet){
            var result1 = [];
            var result2 = [];
            var result3 = [];
            var result4 = [];
            var result5 = [];
            var result6 = [];
            var result7 = [];
            var result8 = [];
            var result9 = [];
            var result10 = [];
            var result11 = [];
            var result12 = [];
            var result13 = [];
            var result14 = [];
            var result15 = [];
            var result16 = [];
            var result17 = [];
            var result18 = [];
            var result19 = [];
            var result20 = [];
            var result21 = [];
            var result22 = [];
            var result23 = [];
            var result24 = [];
            var result25 = [];
            var result26 = [];
            var result27 = [];
            var result28 = [];
            var result29 = [];
            var result30 = [];
            var result31 = [];
            var resultall = [];
            for (var i = 0;i < dataSet.length; i = i + 31){
                if (dataSet[i + 1] != 0){result1.push(dataSet[i + 1]);}
                if (dataSet[i + 2] != 0){result2.push(dataSet[i + 2]);}
                if (dataSet[i + 3] != 0){result3.push(dataSet[i + 3]);}
                if (dataSet[i + 4] != 0){result4.push(dataSet[i + 4]);}
                if (dataSet[i + 5] != 0){result5.push(dataSet[i + 5]);}
                if (dataSet[i + 6] != 0){result6.push(dataSet[i + 6]);}
                if (dataSet[i + 7] != 0){result7.push(dataSet[i + 7]);}
                if (dataSet[i + 8] != 0){result8.push(dataSet[i + 8]);}
                if (dataSet[i + 9] != 0){result9.push(dataSet[i + 9]);}
                if (dataSet[i + 10] != 0){result10.push(dataSet[i + 10]);}
                if (dataSet[i + 11] != 0){result11.push(dataSet[i + 11]);}
                if (dataSet[i + 12] != 0){result12.push(dataSet[i + 12]);}
                if (dataSet[i + 13] != 0){result13.push(dataSet[i + 13]);}
                if (dataSet[i + 14] != 0){result14.push(dataSet[i + 14]);}
                if (dataSet[i + 15] != 0){result15.push(dataSet[i + 15]);}
                if (dataSet[i + 16] != 0){result16.push(dataSet[i + 16]);}
                if (dataSet[i + 17] != 0){result17.push(dataSet[i + 17]);}
                if (dataSet[i + 18] != 0){result18.push(dataSet[i + 18]);}
                if (dataSet[i + 19] != 0){result19.push(dataSet[i + 19]);}
                if (dataSet[i + 20] != 0){result20.push(dataSet[i + 20]);}
                if (dataSet[i + 21] != 0){result21.push(dataSet[i + 21]);}
                if (dataSet[i + 22] != 0){result22.push(dataSet[i + 22]);}
                if (dataSet[i + 23] != 0){result23.push(dataSet[i + 23]);}
                if (dataSet[i + 24] != 0){result24.push(dataSet[i + 24]);}
                if (dataSet[i + 25] != 0){result25.push(dataSet[i + 25]);}
                if (dataSet[i + 26] != 0){result26.push(dataSet[i + 26]);}
                if (dataSet[i + 27] != 0){result27.push(dataSet[i + 27]);}
                if (dataSet[i + 28] != 0){result28.push(dataSet[i + 28]);}
                if (dataSet[i + 29] != 0){result29.push(dataSet[i + 29]);}
                if (dataSet[i + 30] != 0){result30.push(dataSet[i + 30]);}
                if (dataSet[i + 31] != 0){result31.push(dataSet[i]);}
            }
            result31 = delRepeat2(result31);
            resultall.push(result1,result2,result3,result4,result5,result6,result7,result8,result9,result10,result11,result12,result13,result14,result15,result16,result17,result18,result19,result20,result21,result22,result23,result24,result25,result26,result27,result28,result29,result30 );
            var data = echarts.dataTool.prepareBoxplotData(resultall);
            var d1=['S1','S2','S3','S4','S5','S6','S7','S8','S9','S10','S11','S12','S13','S14','S15','S16','S17','S18','S19','S20','S21','S22','S23','S24','S25','S26','S27','S28','S29','S30'];
            var option;
            option = {
                title: [
                    {
                        text: 'The distribution of mutation signature in patients with '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center',
                    },
                    {
                        subtext: 'S:signature \nS1:small numbers of small insertions and deletions \nS2:mutations in exons \nS3:elevated numbers of large (longer than 3bp) insertions and deletions\nS4:bias for C>A mutations \nS5:bias for T>C substitutions at ApTpN context \nS6,S15,S20,S26:high numbers of small (shorter than 3bp) insertions and deletions at \nmono/polynucleotide repeats \nS7:large numbers of CC>TT dinucleotide mutations at dipyrimidines \nS8:weak bias for C>A substitutions \nS9,S17,S18,S19,S21,S28,S30:N/A \nS10:bias for C>A mutations at TpCpT context and T>G mutations at TpTpT context \nS11,S23:strong bias for C>T mutations \nS12:strong bias for T>C substitutions \nS13:predominantly C>G mutations \nS14:very high numbers of somatic mutations (>200 mutations per MB) \nS16:strong bias for T>C mutations at ApTpN context \nS22,S27:strong bias for T>A mutations \nS24:strong bias for C>A mutations \nS25:bias for T>A mutations \nS29:bias for C>A mutations',
                        borderColor: 'grey',
                        borderWidth: 1,
                        textStyle: {
                            fontSize: 12,
                            color:'grey'
                        },
                        sublink:'https://cancer.sanger.ac.uk/signatures/signatures_v2/',
                        left: '6%',
                        top: '58%'
                    }
                ],
                tooltip: {
                    trigger: 'item',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    top:'10%',
                    left: '10%',
                    right: '10%',
                    bottom: '50%'
                },
                xAxis: {
                    type: 'category',
                    data: d1,
                    boundaryGap: true,
                    nameGap: 30,
                    splitArea: {
                        show: false
                    },
                    axisLabel: {
                        interval:0,
                        rotate:75,
                        formatter: '{value}'
                    },
                    splitLine: {
                        show: false
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'Percentage',
                    splitArea: {
                        show: true
                    }
                },
                series: [
                    {
                        name: 'boxplot',
                        type: 'boxplot',
                        data: data.boxData,
                        tooltip: {
                            formatter: function (param) {
                                return [
                                    param.name + ': ',
                                    'upper: ' + param.data[5],
                                    'Q3: ' + param.data[4],
                                    'median: ' + param.data[3],
                                    'Q1: ' + param.data[2],
                                    'lower: ' + param.data[1]
                                ].join('<br/>')
                            }
                        }
                    },
                    {
                        name: 'outlier',
                        type: 'scatter',
                        data: data.outliers
                    }
                ]
            };
            if (option && typeof option === 'object') {
                myChart3.setOption(option);
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--type germline-->
<script type="text/javascript" th:fragment="typeGN">
    const aT_2 = window.document.querySelector('#downloadT1_2')
    aT_2.addEventListener('click',()=>{
        const contentT_2 = document.querySelector('#echartsBrowseGermlineType1 svg').outerHTML
        const blobT_2= new Blob([contentT_2], {type: 'xml/svg'})
        aT_2.href = URL.createObjectURL(blobT_2)
        aT_2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseGermlineType1'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:45,
            }
        },
        yAxis:{},
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneNumberByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var numberall = [];
            for (var i = 0;i < data.length;i = i + 2){
                data[i + 1] = Number(data[i + 1]);
                if(data[i + 1] != 0){
                    var number = {};
                    number['value'] = data[i + 1];
                    number['name'] = data[i];
                    numberall.push(number);
                }
            }
            numberall.sort(function (a,b) {return b.value -a.value});
            var arrnum = numberall.length;
            if(arrnum == 0){
                document.getElementById("echartsBrowseGermlineType1").innerHTML="Sorry, no germline mutations were detected in this cancer.";
            }
            else {
                var categories =[];
                var numberall1 =[];
                if (arrnum >20){
                    numberall1 = numberall.splice(20);
                }
                for (var j = 0;j < numberall.length;j++){
                    categories[j] = numberall[j].name;
                }
                myChart1.setOption({
                    title: {
                        text:'The number of germline mutations \noccurring in top 20 mutated genes in '+ type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeGC">
    const aT2_2 = window.document.querySelector('#downloadT2_2')
    aT2_2.addEventListener('click',()=>{
        const contentT2_2 = document.querySelector('#echartsBrowseGermlineType2 svg').outerHTML
        const blobT2_2= new Blob([contentT2_2], {type: 'xml/svg'})
        aT2_2.href = URL.createObjectURL(blobT2_2)
        aT2_2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseGermlineType2'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            data:[],
            axisLabel:{
                interval:0,
                rotate:45,
            }
        },
        yAxis:{},
        series:[{name:'Ratio',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatioByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var numberall = [];
            for (var i = 0;i < data.length;i = i + 2){
                data[i + 1] = Number(data[i + 1]);
                if(data[i + 1] != 0){
                    var number = {};
                    number['value'] = data[i + 1];
                    number['name'] = data[i];
                    numberall.push(number);
                }
            }
            numberall.sort(function (a,b) {return b.value -a.value});
            var arrnum = numberall.length;
            if(arrnum == 0){
                document.getElementById("echartsBrowseGermlineType2").innerHTML="Sorry, no germline mutations were detected in this cancer.";
            }
            else {
                var categories =[];
                var numberall1 =[];
                if (arrnum >20){
                    numberall1 = numberall.splice(20);
                }
                for (var j = 0;j < numberall.length;j++){
                    categories[j] = numberall[j].name;
                }
                myChart1.setOption({
                    title: {
                        text:'The carrier ratio of germline mutations \noccurring in top 20 mutated genes in '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeGComT">
    const aT4_2 = window.document.querySelector('#downloadT4_2')
    aT4_2.addEventListener('click',()=>{
        const contentT4_2 = document.querySelector('#echartsBrowseGermlineType4 svg').outerHTML
        const blobT4_2= new Blob([contentT4_2], {type: 'xml/svg'})
        aT4_2.href = URL.createObjectURL(blobT4_2)
        aT4_2.download = 'newplot.svg'
    })
    var myChart4 =echarts.init(document.querySelector('#echartsBrowseGermlineType4'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseGermlineGeneRatioVsTcgaByType?type=" + type,
        async:false,
        cache:false,
        success:function (data){
            var result1 = '["product", "Genecast", "TCGA"]';
            for (var i = 0;i < data.length; i = i + 4){
                data[i]=Number(data[i]);
                data[i+1]=Number(data[i+1]);
                if(data[i] != 0){
                    result1 = result1 +",[" + "\""+data[i+2]+"\""+","+data[i] +","+ data[i+1] +"]";
                }
            }
            var data1=JSON.parse("[" + result1 + "]");
            var arrnum = data1.length;
            if(arrnum <= 1){
                document.getElementById("echartsBrowseGermlineType4").innerHTML="Sorry, this cancer type is not recorded in TCGA or no germline mutations were detected in this cancer.";
            }
            else {
                var numberall1 =[];
                if (arrnum >21){
                    numberall1 = data1.splice(21);
                }
                var option;
                option = {
                    title: {
                        text:'The carrier ratio of germline mutations within top 20 mutated genes \ncompared with TCGA in '+type,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    legend: {
                        orient: 'horizontal',
                        x:'center',
                        y:'top',
                        padding:[40,0,0,0],
                        align:'left',
                    },
                    tooltip: {},
                    dataset: {
                        source: data1
                    },
                    toolbox: {
                        top:20,
                        feature: {
                            magicType : {show: true, type: ['line','bar']},
                        }
                    },
                    xAxis: {
                        axisLabel:{
                            interval:0,
                            rotate:45,
                        },
                        type: 'category'
                    },
                    yAxis: {},
                    series: [
                        {type: 'line'},
                        {type: 'line'}
                    ]
                };
                if (option && typeof option === 'object') {
                    myChart4.setOption(option);
                }
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--type clinical-->
<script type="text/javascript" th:fragment="typeCDG">
    const aC = window.document.querySelector('#downloadC1')
    aC.addEventListener('click',()=>{
        const contentC = document.querySelector('#echartsBrowseClinicalType1 svg').outerHTML
        const blobC= new Blob([contentC], {type: 'xml/svg'})
        aC.href = URL.createObjectURL(blobC)
        aC.download = 'newplot.svg'
    })
    var myChart3 =echarts.init(document.querySelector('#echartsBrowseClinicalType1'), null, {renderer: 'svg'});
    $.ajax({
        url:"/cpgv/BrowseClinicalGenderByType?type=" + type,
        async:false,
        cache:false,
        success:function (dataSet){
            var img = 'data:image/png;base64,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';
            const man =
                'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAByCAMAAADzq6aiAAABpFBMVEUAAAAA//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A//8A///ZqXRjAAAAi3RSTlMAAQIDBAYICQoMDQ4RExQWGBkaGxweHyAmJyksLTU4OTo7PD5AQkZHTk9QUVJTVFVYWVpgZGhqa21ucXJzdHZ5fX+AgYKDhoeIi5CRk5WWmZqbn6ChoqOlpqeoqaqsrrW2t7i5uru8vcPFx8jQ0tTX293e4OHi4+Tl5+jr7e7v8PHy8/T2+fr7/P3+d8xxFQAAAmtJREFUaN7t2vlb0zAYB/AAm1zeyKGIByKiQ9zwxgMRhifMCYooh4qgzrMw2awKKhZs80+7jbqkkGzpm/mDz/N+f1rfJZ9nT9ulTVNCiqfu0nTSspJPL9eRUmTnyBp1s/Zgt753/BvlshzS9c7a1BP7nJ53coOXEbt0vPoluinfGzTAJ1SQCbi31xaB9j4weJMKcwsMvhODH6BetS0GnRog2Ewl2Q8ED8vAQ0CwRQa2AMFdMnAP9Kh8EXtLZVBwQgxOgc/DTjF4CgwGDJE3H4D/mbtEoNb4NbbZG9MaYCtfbfQSVXpDdvW013tWq3tRKe/5wbifV8pLcB3dfv3jOmf07wBdRyIDsdH4bZZYLPZ8cXU1NZP5cIeV46P3Brrri2ll4YRDfcR5Eym4ExpeU99JNMq9ps8UELNZ5m01KCjJbRJwhALzUDJA21DQOSgE71Na2p9owMGUELRYA2u2qG7Mcu0dIcifCaSvGNhHTG4LQQQRRBBBBBFEEEG/4C/2/aIKuMDd/gnBt6zBSxXwBdt4LwSjrEGPCniBbdwQPxtdzu/CWhWwJp2fU0qepHb+dvdIO1EBSZt7U2xHZDOfjtxMauEoUQNJW+64mCcKTODDg9FQkKiCJBiKDobVpvhqoI/8Y3AlnclKCcHhbGkYQQQRRBBBBBFEEMH/Brzm6T2ULd3VAs97ekezpX5P6aJP8ICnd+79iw5PqdXvYtk8v1ybu9Gv/MqVPlX4Xes6zfXuXS9d5Upn/K+ePc53nnNXVwNz+dIkYDmuYshdPxvf8rdU5b6Z4cSDoBXC1kcpy5w6xpfaJ00rPX6kQKc/RsXweS7aQLIAAAAASUVORK5CYII=';
            const woman =
                'data:image/png;base64,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';
            var sexData = [{
                name: 'Male',
                value: parseInt(dataSet[2])
            }, {
                name: 'Female',
                value: parseInt(dataSet[1])
            }];
            var data = [];
            var color = ['#4171FF', "#FF7F9E", '#ffa800', '#ff5b00', '#ff3000']
            for (var i = 0; i < sexData.length; i++) {
                data.push({
                    value: sexData[i].value,
                    name: sexData[i].name,
                    itemStyle: {
                        normal: {
                            borderWidth: 5,
                            shadowBlur: 20,
                            borderColor: color[i],
                            shadowColor: color[i]
                        }
                    }
                }, {
                    value: 2,
                    name: '',
                    itemStyle: {
                        normal: {
                            label: {
                                show: false
                            },
                            labelLine: {
                                show: false
                            },
                            color: 'rgba(0, 0, 0, 0)',
                            borderColor: 'rgba(0, 0, 0, 0)',
                            borderWidth: 0
                        }
                    }
                });
            }
            var seriesOption = [{
                name: '',
                type: 'pie',
                clockWise: false,
                radius: [105, 109],
                hoverAnimation: false,
                itemStyle: {
                    normal: {
                        label: {
                            show: true,
                            position: [0, -20],
                            color: 'black',
                            formatter: function(params) {
                                var percent = 0;
                                var total = 0;
                                for (var i = 0; i < sexData.length; i++) {
                                    total += sexData[i].value;
                                }
                                percent = ((params.value / total) * 100).toFixed(0);
                                if (params.name !== '') {
                                    return params.name + '：' + percent + '%';
                                } else {
                                    return '';
                                }
                            },
                        },
                        labelLine: {
                            length: 20,
                            length2: 30,
                            show: true,
                            color: '#4171FF'
                        }
                    }
                },
                data: data
            }];
            option = {
                title: {
                    left:'center',
                    text:'The distribution of sex in patients with '+type,
                    textStyle:{
                        fontSize:14,
                    },
                },
                backgroundColor: 'white',
                color: color,
                graphic: {
                    elements: [{
                        type: "image",
                        z: 3,
                        style: {
                            image: img,
                            width: 178,
                            height: 178
                        },
                        left: 'center',
                        top: 'center',
                        position: [100, 100]
                    }, {
                        type: 'image',
                        z: 3,
                        style: {
                            image: woman,
                            width: 65,
                            height: 100
                        },
                        left: '50%',
                        top: 'center'
                    },
                        {
                            type: 'image',
                            z: 3,
                            style: {
                                image: man,
                                width: 65,
                                height: 100
                            },
                            right: '50%',
                            top: 'center'
                        }
                    ]
                },
                tooltip: {
                    show: false
                },
                series: seriesOption
            };
            if (option && typeof option === 'object') {
                myChart3.setOption(option);
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="typeCDA">
    var TESTER = document.getElementById("echartsBrowseClinicalType2");
    $.ajax({
        url:"/cpgv/BrowseClinicalAgeByType?type=" + type,
        async:false,
        cache:false,
        success:function (dataSet){
            var result1 = [];
            var result2 = [];
            for (var i = 0;i < dataSet.length; i = i + 2){
                result1.push(parseInt(dataSet[i + 1]));
                result2.push(dataSet[i]);
            }
            result2 = delRepeat2(result2);
            var rows = [];
            var tumor = result2[0];
            for (var j = 0;j < result1.length; j++) {
                let temparray ={};
                temparray["EXPRESSION_VALUE"] = result1[j];
                temparray["GROUP_NAME"] = tumor;
                temparray["GROUP_SHORT"] = tumor;
                rows.push(temparray);
            }
            function unpack(rows, key) {
                return rows.map(function(row) { return row[key]; });
            }
            var data = [{
                type: 'violin',
                x: unpack(rows, 'GROUP_SHORT'),
                y: unpack(rows, 'EXPRESSION_VALUE'),
                points: 'none',
                hoverinfo: 'y',
                box: {
                    visible: true
                },
                line: {
                    color: 'blue',
                },
                meanline: {
                    visible: true
                },
            }];
            var layout = {
                title: { text: "The distribution of age in patients with "+type, font: { size: 14,family: "Arial black"}},
                xaxis: {
                    "tickangle": 0,
                    title: {
                    },
                },
                yaxis: {
                    zeroline: false,
                    title: {
                        text: 'Age (years old)'
                    },
                },
            };
            var config = {
                toImageButtonOptions: {
                    format: 'svg',
                    filename: "newplot",
                    height: 450,
                    width: 800,
                    scale: 1
                },
                modeBarButtonsToRemove: ['zoom2d',"zoomIn2d","zoomOut2d", 'resetScale2d', 'toggleSpikelines','pan2d', 'sendDataToCloud', "select2d","lasso2d",'hoverClosestCartesian', 'autoScale2d', 'hoverCompareCartesian'],
                displaylogo: false,
                displayModeBar: true,
            };
            Plotly.newPlot(TESTER, data, layout, config);
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--site somatic-->
<script type="text/javascript" th:fragment="siteSN">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var pid0=document.getElementsByTagName("table")[0].rows[2].cells[1].innerHTML;
    var pid=gene+"."+pid0;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD','all'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue','black'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    pid01 = pid0;
    pid01 = pid01.replace("&gt;",">");
    const aS1 = window.document.querySelector('#downloadS1')
    aS1.addEventListener('click',()=>{
        const contentS1 = document.querySelector('#echartsBrowseSomaticSite1 svg').outerHTML
        const blobS1= new Blob([contentS1], {type: 'xml/svg'})
        aS1.href = URL.createObjectURL(blobS1)
        aS1.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseSomaticSite1'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [30, 0, 0, 0]
            },
            data:[],
            axisLabel:{
                interval:0,
                rotate:75
            }
        },
        yAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [0, 0, 25, 0]
            }
        },
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/SearchSomaticSiteNumber",
        async:false,
        cache:false,
        data:{pid:pid},
        type:"post",
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i + 1] = Number(data[i + 1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticSite1").innerHTML="Sorry, no somatic mutations in this locus of the gene.";
            }
            else {
                myChart1.setOption({
                    title: {
                        text:'The number of somatic mutation site ('+ pid01 +") in "+ gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="siteSC">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var pid0=document.getElementsByTagName("table")[0].rows[2].cells[1].innerHTML;
    var pid=gene+"."+pid0;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD','all'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue','black'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    pid01 = pid0;
    pid01 = pid01.replace("&gt;",">");
    const aS2 = window.document.querySelector('#downloadS2')
    aS2.addEventListener('click',()=>{
        const contentS2 = document.querySelector('#echartsBrowseSomaticSite2 svg').outerHTML
        const blobS2= new Blob([contentS2], {type: 'xml/svg'})
        aS2.href = URL.createObjectURL(blobS2)
        aS2.download = 'newplot.svg'
    })
    var myChart2 =echarts.init(document.querySelector('#echartsBrowseSomaticSite2'), null, {renderer: 'svg'});
    myChart2.setOption({
        tooltip: {},
        xAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [30, 0, 0, 0]
            },
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [0, 0, 25, 0]
            }
        },
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/SearchSomaticSiteRatio",
        async:false,
        cache:false,
        data:{pid:pid},
        type:"post",
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i + 1] = Number(data[i + 1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseSomaticSite2").innerHTML="Sorry, no somatic mutations in this locus of the gene.";
            }
            else {
                myChart2.setOption({
                    title: {
                        text:'The carrier ratio of somatic mutation site ('+ pid01 +") in "+ gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--site germline-->
<script type="text/javascript" th:fragment="siteGN">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var pid0=document.getElementsByTagName("table")[0].rows[2].cells[1].innerHTML;
    var pid=gene+"."+pid0;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD','all'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue','black'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    pid01 = pid0;
    pid01 = pid01.replace("&gt;",">");
    const aS1_2 = window.document.querySelector('#downloadS1_2')
    aS1_2.addEventListener('click',()=>{
        const contentS1_2 = document.querySelector('#echartsBrowseGermlineSite1 svg').outerHTML
        const blobS1_2= new Blob([contentS1_2], {type: 'xml/svg'})
        aS1_2.href = URL.createObjectURL(blobS1_2)
        aS1_2.download = 'newplot.svg'
    })
    var myChart1 =echarts.init(document.querySelector('#echartsBrowseGermlineSite1'), null, {renderer: 'svg'});
    myChart1.setOption({
        tooltip: {},
        xAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [30, 0, 0, 0]
            },
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [0, 0, 25, 0]
            }
        },
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/SearchGermlineSiteNumber",
        async:false,
        cache:false,
        data:{pid:pid},
        type:"post",
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i + 1] = Number(data[i + 1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineSite1").innerHTML="Sorry, no germline mutations in this locus of the gene.";
            }
            else {
                myChart1.setOption({
                    title: {
                        text:'The number of germline mutation site ('+ pid01 +") in "+ gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<script type="text/javascript" th:fragment="siteGC">
    var gene=document.getElementsByTagName("table")[0].rows[0].cells[1].innerHTML;
    var pid0=document.getElementsByTagName("table")[0].rows[2].cells[1].innerHTML;
    var pid=gene+"."+pid0;
    var datacancer = ['ACC','THCA','PRAD','BLCA','GIST','NE','SARC','UCEC','GBM','SKCM','KICH','HNSC','CESC','NASO','SCL','OV','CHOL','BRCA','ESCA','PAAD','LIHC','READ','LUSC','STAD','COAD','NSCL','LUAD','all'];
    var hashcolor =['Navy','CornflowerBlue','SlateGray','LightSkyBlue','LightSteelBlue','DeepSkyBlue','CadetBlue','Aqua','DarkCyan','MediumSpringGreen','MediumSeaGreen','Green','Olive','DarkKhaki','DarkGoldenrod','SaddleBrown','FireBrick','Maroon','DimGray','Crimson','PaleVioletRed','MediumVioletRed','Purple','MediumOrchid','Indigo','SlateBlue','Blue','black'];
    var hashcol = {};
    for (var i = 0; i < hashcolor.length; i++) {
        hashcol[datacancer[i]] = hashcolor[i];
    }
    pid01 = pid0;
    pid01 = pid01.replace("&gt;",">");
    console.log(pid01);
    const aS2_2 = window.document.querySelector('#downloadS2_2')
    aS2_2.addEventListener('click',()=>{
        const contentS2_2 = document.querySelector('#echartsBrowseGermlineSite2 svg').outerHTML
        const blobS2_2= new Blob([contentS2_2], {type: 'xml/svg'})
        aS2_2.href = URL.createObjectURL(blobS2_2)
        aS2_2.download = 'newplot.svg'
    })
    var myChart2 =echarts.init(document.querySelector('#echartsBrowseGermlineSite2'), null, {renderer: 'svg'});
    myChart2.setOption({
        tooltip: {},
        xAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [30, 0, 0, 0]
            },
            data:[],
            axisLabel:{
                interval:0,
                rotate:75,
            }
        },
        yAxis:{
            name:'',
            nameLocation:'center',
            nameTextStyle: {
                padding: [0, 0, 25, 0]
            }
        },
        series:[{name:'Number',type:'bar',barMaxWidth: 30,data:[]}]
    });
    $.ajax({
        url:"/cpgv/SearchGermlineSiteRatio",
        async:false,
        cache:false,
        data:{pid:pid},
        type:"post",
        success:function (data){
            var categories =[];
            var numberall = [];
            var j = 0;
            for (var i = 0;i < data.length;){
                data[i + 1] = Number(data[i + 1]);
                var number = {};
                var colortmp = {};
                j = i / 2;
                categories[j] = data[i];
                number['value'] = data[i + 1];
                colortmp['color'] = hashcol[data[i]];
                number['itemStyle'] = colortmp;
                number['name'] = data[i];
                numberall.push(number);
                i = i + 2;
            }
            var arrnum = numberall.length;
            var sum =0;
            for (var g=0;g<arrnum;g++){
                sum = sum +numberall[g].value;
            }
            if(sum == 0){
                document.getElementById("echartsBrowseGermlineSite2").innerHTML="Sorry, no germline mutations in this locus of the gene.";
            }
            else {
                myChart2.setOption({
                    title: {
                        text:'The carrier ratio of germline mutation site ('+ pid01 +") in "+ gene,
                        textStyle:{
                            fontSize:14,
                        },
                        left: 'center'
                    },
                    xAxis: {data: categories},
                    series:[{data:numberall}]
                });
            }
        },
        error:function (error){
            console.log(error);
        }
    });
</script>

<!--search-->
<script type="text/javascript" th:fragment="search1">
    $(document).ready(function(){
        $('#searchItem').change(function () {
            var selectval = $("#searchItem").val();
            if (selectval == "1"){
                clearAll();
                $(document).ready(function(){
                    $('#searchName').select2({
                        placeholder: 'Please input gene name you interested',
                        minimumInputLength: 1,
                        ajax: {
                            url: '/cpgv/SearchByParamGene',
                            dataType: 'json',
                            delay: 250,
                            data: function (params) {
                                var query = {
                                    param1: params.term
                                }
                                return query;
                            },
                            processResults: function (data) {
                                var result = [];
                                for (var i = 0; i < data.length; i++) {
                                    result[i] = {id: data[i], text: data[i]};
                                }
                                return {
                                    results: result
                                };
                            }
                        },
                    });
                });
            }else if(selectval == "2"){
                clearAll();
                $(document).ready(function(){
                    $('#searchName').select2({
                        placeholder: 'Please input cancer type you interested',
                        minimumInputLength: 1,
                        ajax: {
                            url: '/cpgv/SearchByParamType',
                            dataType: 'json',
                            delay: 250,
                            data: function (params) {
                                var query = {
                                    param2: params.term
                                }
                                return query;
                            },
                            processResults: function (data) {
                                var result = [];
                                for (var i = 0; i < data.length; i++) {
                                    result[i] = {id: data[i], text: data[i]};
                                }
                                return {
                                    results: result
                                };
                            }
                        },
                    });
                });
            }else if(selectval == "3"){
                clearAll();
                $(document).ready(function(){
                    $('#searchName').select2({
                        placeholder: 'Please input pathway name you interested',
                        minimumInputLength: 1,
                        ajax: {
                            url: '/cpgv/SearchByParamPathway',
                            dataType: 'json',
                            delay: 250,
                            data: function (params) {
                                var query = {
                                    param3: params.term
                                }
                                return query;
                            },
                            processResults: function (data) {
                                var result = [];
                                for (var i = 0; i < data.length; i++) {
                                    result[i] = {id: data[i], text: data[i]};
                                }
                                return {
                                    results: result
                                };
                            }
                        },
                    });
                });
            }else if(selectval == "4"){
                clearAll();
                $(document).ready(function(){
                    $('#searchName').select2({
                        placeholder: 'Please input mutation site you interested',
                        minimumInputLength: 1,
                        ajax: {
                            url: '/cpgv/SearchByParamSite',
                            dataType: 'json',
                            delay: 250,
                            data: function (params) {
                                var query = {
                                    param4: params.term
                                }
                                return query;
                            },
                            processResults: function (data) {
                                var result = [];
                                for (var i = 0; i < data.length; i++) {
                                    result[i] = {id: data[i], text: data[i]};
                                }
                                return {
                                    results: result
                                };
                            }
                        },
                    });
                });
            }else{
                //alert("Error! Please input right text!")
            }
        });
    });
</script>

<script type="text/javascript" th:fragment="search2">
    function checkvalues(){
        var selectval = $("#searchName option:selected").text();  //取text值
        if (selectval == ""){
            alert("Please input at least one character!");
            return false;
        }else{
            return true;
        }

    }
</script>

<script type="text/javascript" th:fragment="search3">
    function clearAll(){
        $("#searchName").val(null).trigger("change");
    }
</script>



<!--statistics-->
<script type="text/javascript" th:fragment="statistics">
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?27b268e347c74c5facf98218cc460de9";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>
</html>